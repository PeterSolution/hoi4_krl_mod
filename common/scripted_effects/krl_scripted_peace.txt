axis_capitulation_peace_deal = {
	#Comintern
	if = {
		limit = {
			has_global_flag = SOV_capitulated
		}

		ENG = {
			annex_country = { target = GER transfer_troops = no }
			annex_country = { target = BLR transfer_troops = no } 
			annex_country = { target = UKR transfer_troops = no } 
			annex_country = { target = GP1 transfer_troops = no } 
			annex_country = { target = GP2 transfer_troops = no } 
			annex_country = { target = GP3 transfer_troops = no } 
			annex_country = { target = GP4 transfer_troops = no } 
			annex_country = { target = HUN transfer_troops = no } 
			annex_country = { target = ROM transfer_troops = no } 
			annex_country = { target = BUL transfer_troops = no } 

			release = ROM
			release = HUN
			release = BUL
			release = LIT
			release = LAT
			release = EST
			release = MON
			release = SOV

			add_to_faction = CZE
			add_to_faction = ROM
			add_to_faction = BUL
			add_to_faction = YUG
			add_to_faction = SOV
			add_to_faction = HUN
			add_to_faction = ALB
			add_to_faction = AUS
		}

		LIT = {
			transfer_state = 188
		}
		SOV = {
			set_cosmetic_tag = russian_empire
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 50
				fascism = 5
				neutrality = 5
				communism = 40
			}

			transfer_state = 213
			transfer_state = 722
			transfer_state = 146
			transfer_state = 216
			transfer_state = 215

			every_state = {
				limit = {
					is_owned_by = ENG
					is_core_of = SOV
				}
				SOV = {
					transfer_state = PREV
				}
			}
		}
		WGR = {
			add_state_core = 60
			add_state_core = 61
			add_state_core = 62
			add_state_core = 64
			add_state_core = 65

			transfer_state = 60
			transfer_state = 61
			transfer_state = 62
			transfer_state = 64
			transfer_state = 65
		}
		HUN = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 43
			transfer_state = 154
			transfer_state = 155
		}
		ROM = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 81
			transfer_state = 82
			transfer_state = 83
			transfer_state = 84
			transfer_state = 46
			transfer_state = 76
			transfer_state = 79
		}
		BUL = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 48
			transfer_state = 212
			transfer_state = 801
			transfer_state = 211
			transfer_state = 77
		}
		CZE = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 664
			transfer_state = 71
			transfer_state = 70
			transfer_state = 75
			transfer_state = 69
			transfer_state = 9
			transfer_state = 74
			transfer_state = 73
		}
		POL = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 88
			transfer_state = 762
			transfer_state = 90
			transfer_state = 10
			transfer_state = 92
			transfer_state = 97
			transfer_state = 98
			transfer_state = 87
			transfer_state = 86
			transfer_state = 807
			transfer_state = 85
			transfer_state = 72
			transfer_state = 66
			transfer_state = 67
			transfer_state = 68
			transfer_state = 63
			transfer_state = 5
			transfer_state = 89
			transfer_state = 91
			transfer_state = 93
			transfer_state = 94
			transfer_state = 95
			transfer_state = 96
			transfer_state = 763
			transfer_state = 784
		}
		ALB = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 80
				fascism = 0
				neutrality = 10
				communism = 10
			}

			transfer_state = 805
			transfer_state = 44
		}
		YUG = {
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 50
				fascism = 0
				neutrality = 10
				communism = 40
			}

			transfer_state = 102
			transfer_state = 109
			transfer_state = 853
			transfer_state = 103
			transfer_state = 104
			transfer_state = 163
			transfer_state = 105
			transfer_state = 804
			transfer_state = 802
			transfer_state = 106
			transfer_state = 803
			transfer_state = 108
			transfer_state = 107
			transfer_state = 764
			transfer_state = 45
		}
		MON = {
			set_cosmetic_tag = NEUTRAL
			
			set_politics = {
				ruling_party = democratic
				election_frequency = 48
				elections_allowed = yes
			}
			set_popularities = {
				democratic = 50
				fascism = 0
				neutrality = 10
				communism = 40
			}
		}
	} 
	else = {
		if = {
			limit = {
				POL = {
					has_war_with = JAP
				}
			}
			POL = {
				white_peace = JAP
				if = {
					limit = {
						is_in_faction_with = ENG
					}
					leave_faction = yes
				}
			}
		}
		if = {
			limit = {
				YUG = {
					has_war_with = JAP
				}
			}
			YUG = {
				white_peace = JAP
				if = {
					limit = {
						is_in_faction_with = ENG
					}
					leave_faction = yes
				}
			}
		}
		SOV = {
			if = {
				limit = {
					SOV = {
						is_puppet = yes
						exists = no
					}
				}
				every_state = {
					limit = {
						is_core_of = SOV
					}
					SOV = {
						transfer_state = PREV
					}
				}
			}

			puppet = DDR
			puppet = HUN
			puppet = ROM
			puppet = BUL
			puppet = CZE
			puppet = POL
			puppet = ALB
			puppet = YUG

			transfer_state = 4
			transfer_state = 766
			transfer_state = 78
			transfer_state = 89
			transfer_state = 80
			transfer_state = 91
			transfer_state = 93					
			transfer_state = 94
			transfer_state = 95
			transfer_state = 96
			transfer_state = 784
			transfer_state = 784
			transfer_state = 763

			DDR = {
				set_cosmetic_tag = SOV_PUPPET

				add_state_core = 60
				add_state_core = 61
				add_state_core = 62
				add_state_core = 64
				add_state_core = 65

				transfer_state = 60
				transfer_state = 61
				transfer_state = 62
				transfer_state = 64
				transfer_state = 65
			}
			HUN = {
				set_cosmetic_tag = SOV_PUPPET

				transfer_state = 43
				transfer_state = 154
				transfer_state = 155
			}
			ROM = {
				set_cosmetic_tag = SOV_PUPPET

				transfer_state = 81
				transfer_state = 82
				transfer_state = 83
				transfer_state = 84
				transfer_state = 46
				transfer_state = 76
				transfer_state = 79
			}
			BUL = {
				set_cosmetic_tag = SOV_PUPPET

				transfer_state = 48
				transfer_state = 212
				transfer_state = 801
				transfer_state = 211
				transfer_state = 77
			}
			CZE = {
				set_cosmetic_tag = SOV_PUPPET
				transfer_state = 664
				transfer_state = 71
				transfer_state = 70
				transfer_state = 75
				transfer_state = 69
				transfer_state = 9
				transfer_state = 74
				transfer_state = 73
			}
			POL = {
				set_cosmetic_tag = SOV_PUPPET
				transfer_state = 88
				transfer_state = 762
				transfer_state = 90
				transfer_state = 10
				transfer_state = 92
				transfer_state = 97
				transfer_state = 98
				transfer_state = 87
				transfer_state = 86
				transfer_state = 807
				transfer_state = 85
				transfer_state = 72
				transfer_state = 66
				transfer_state = 67
				transfer_state = 68
				transfer_state = 63
				transfer_state = 5
			}
			ALB = {
				set_cosmetic_tag = SOV_PUPPET
				transfer_state = 805
				transfer_state = 44
			}
			YUG = {
				set_cosmetic_tag = SOV_PUPPET

				transfer_state = 102
				transfer_state = 109
				transfer_state = 853
				transfer_state = 103
				transfer_state = 104
				transfer_state = 163
				transfer_state = 105
				transfer_state = 804
				transfer_state = 802
				transfer_state = 106
				transfer_state = 803
				transfer_state = 108
				transfer_state = 107
				transfer_state = 764
				transfer_state = 45
			}
		}								
		every_state = {
			limit = {
				OR = {
					is_core_of = LIT
					is_core_of = LAT
					is_core_of = EST
				}
			}
			SOV = {
				transfer_state = PREV
			}
		}
	}

	#Allies
	WGR = {
		add_state_core = 42
		add_state_core = 50
		add_state_core = 51
		add_state_core = 52
		add_state_core = 53
		add_state_core = 54
		add_state_core = 55
		add_state_core = 56
		add_state_core = 57
		add_state_core = 58
		add_state_core = 59
		add_state_core = 909
		transfer_state = 42
		transfer_state = 50
		transfer_state = 51
		transfer_state = 52
		transfer_state = 53
		transfer_state = 54
		transfer_state = 55
		transfer_state = 56
		transfer_state = 57
		transfer_state = 58
		transfer_state = 59
		transfer_state = 909	
	}
	ETH = {
		transfer_state = 835
		transfer_state = 836
		transfer_state = 837
		transfer_state = 838
		transfer_state = 271
		transfer_state = 843
		transfer_state = 841
		transfer_state = 840
		transfer_state = 839
		transfer_state = 842
		transfer_state = 908
		transfer_state = 559
		transfer_state = 844
		transfer_state = 550
	}
	ITA = {
		set_cosmetic_tag = ENG_puppet_ITA
	}
	USA = {
		puppet = WGR
	}
	AUS = {
		transfer_state = 153
		transfer_state = 152
		transfer_state = 4
		transfer_state = 848
	}
	FRA = {
		annex_country = { target = D04 transfer_troops = no } 
		transfer_state = 1
		transfer_state = 28
		transfer_state = 448
		transfer_state = 661
		transfer_state = 449
		transfer_state = 662
		transfer_state = 273	
		
		transfer_state = 735	
		transfer_state = 31
		transfer_state = 32	
		transfer_state = 25	
		transfer_state = 26	
		transfer_state = 22	
		transfer_state = 20
		transfer_state = 33
		transfer_state = 21	
		transfer_state = 851
		transfer_state = 671
		transfer_state = 670
		transfer_state = 641
		transfer_state = 286

		if = {
			limit = {
				SPR = {
					exists = yes
					OR = {
						has_war_with = FRA
						has_war_with = SOV
					}
				}
			}
			FRA = {
				transfer_state = 290
				transfer_state = 699
				transfer_state = 783
				transfer_state = 178
			}
		}
	}
	GRE = {
		transfer_state = 184
		transfer_state = 731
		transfer_state = 185
		transfer_state = 187
		transfer_state = 47
		transfer_state = 186
		transfer_state = 182
		transfer_state = 164
	}
	HOL = {
		transfer_state = 36
		transfer_state = 7
		transfer_state = 35
	}
	BEL = {
		transfer_state = 34
		transfer_state = 6
	}
	LUX = {
		transfer_state = 8
	}
	DEN = {
		transfer_state = 99
		transfer_state = 37
		transfer_state = 337
	}
	NOR = {
		transfer_state = 110
		transfer_state = 142
		transfer_state = 143
		transfer_state = 144
	}
	ENG = {
		#Get remaining territories
		annex_country = { target = GER transfer_troops = no } 
		annex_country = { target = ITA transfer_troops = no } 
		annex_country = { target = AOI transfer_troops = no } 

		if = {
			limit = {
				ICE = {
					has_war_with = ENG
				}	
			}
			annex_country = { target = ICE transfer_troops = no } 
			release = ICE
			puppet = ICE
		}

		release = SPR
		release = ITA
		release = FRA
		puppet = ITA

		add_to_faction = WGR
		add_to_faction = ETH
		add_to_faction = ITA
		add_to_faction = HOL
		add_to_faction = BEL
		add_to_faction = LUX
		add_to_faction = GRE
		add_to_faction = DEN
		add_to_faction = NOR
		add_to_faction = SPR
		add_to_faction = FRA
		add_to_faction = USA
		add_to_faction = MEX
		
		transfer_state = 663
		transfer_state = 451
		transfer_state = 450
		


	}

	#Neutral
	FIN = {
		if = {
			limit = {
				FIN = {
					is_ai = yes
				}		
			}
			set_cosmetic_tag = NEUTRAL
			add_ideas = krl_neutral
		}
		white_peace = ENG
		white_peace = SOV
		transfer_state = 111
		transfer_state = 149
		transfer_state = 150
		transfer_state = 148
		transfer_state = 147
	}
}

comintern_capitulation_peace_deal = {
	set_global_flag = SOV_capitulated

	GER = {
		annex_country = { target = SOV transfer_troops = no } 
		annex_country = { target = MON transfer_troops = no } 
	}

	JAP = {
		transfer_state = 655
	}

	FIN = {
		transfer_state = 147
		transfer_state = 213
		transfer_state = 722
		transfer_state = 146
		transfer_state = 216
		transfer_state = 215
	}

	ROM = {
		transfer_state = 766
		transfer_state = 78
		transfer_state = 80
	}
	
	BLR = {
		transfer_state = 11
		transfer_state = 784
		transfer_state = 189
		transfer_state = 12
		transfer_state = 190
		transfer_state = 13
		transfer_state = 191
		transfer_state = 97
		transfer_state = 94
		transfer_state = 95
		transfer_state = 96
		transfer_state = 194
		transfer_state = 204
		transfer_state = 206
		transfer_state = 207
		transfer_state = 241
		transfer_state = 784
		transfer_state = 814
		transfer_state = 815
		transfer_state = 809
		transfer_state = 808
		transfer_state = 810
		transfer_state = 813
		transfer_state = 812
		transfer_state = 811

		set_cosmetic_tag = GER_puppet

		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_reichskommissariat  end_wars = no end_civil_wars = no }
		}
	}

	UKR = {
		transfer_state = 93
		transfer_state = 137
		transfer_state = 91
		transfer_state = 89
		transfer_state = 199
		transfer_state = 201
		transfer_state = 198
		transfer_state = 202
		transfer_state = 193
		transfer_state = 192
		transfer_state = 834
		transfer_state = 203
		transfer_state = 197
		transfer_state = 225
		transfer_state = 259
		transfer_state = 226
		transfer_state = 196
		transfer_state = 200
		transfer_state = 221
		transfer_state = 228
		transfer_state = 227
		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_integrated_puppet }
		}
		set_cosmetic_tag = GER_puppet
	}

	GP1 = {
		transfer_state = 249
		transfer_state = 256
		transfer_state = 250
		transfer_state = 651
		transfer_state = 398
		transfer_state = 399
		transfer_state = 400
		transfer_state = 833
		transfer_state = 351
		transfer_state = 880
		transfer_state = 879
		transfer_state = 214
		transfer_state = 825
		transfer_state = 262
		transfer_state = 397
		transfer_state = 581
		transfer_state = 652
		transfer_state = 251

		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_integrated_puppet }
		}
		set_cosmetic_tag = GER_puppet
	}

	GP2 = {
		transfer_state = 577
		transfer_state = 580
		transfer_state = 653
		transfer_state = 573
		transfer_state = 572
		transfer_state = 403
		transfer_state = 570
		transfer_state = 578
		transfer_state = 732
		transfer_state = 742
		transfer_state = 571
		transfer_state = 590
		transfer_state = 882
		transfer_state = 583
		transfer_state = 582
		transfer_state = 402
		transfer_state = 587
		transfer_state = 823
		transfer_state = 584
		transfer_state = 832
		transfer_state = 831
		transfer_state = 881
		transfer_state = 404
		transfer_state = 585
		transfer_state = 405
		transfer_state = 830
		transfer_state = 832
		transfer_state = 586
		transfer_state = 589
		transfer_state = 588
		transfer_state = 619
		transfer_state = 287
		transfer_state = 759
		transfer_state = 760
		transfer_state = 617
		transfer_state = 618
		transfer_state = 824
		transfer_state = 579

		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_integrated_puppet }
		}
		set_cosmetic_tag = GER_puppet
	}
	
	GP3 = {
		transfer_state = 516
		transfer_state = 878
		transfer_state = 576
		transfer_state = 575
		transfer_state = 565
		transfer_state = 564
		transfer_state = 567
		transfer_state = 566
		transfer_state = 568
		transfer_state = 569
		transfer_state = 40
		transfer_state = 654
		transfer_state = 329
		transfer_state = 818
		transfer_state = 330
		transfer_state = 820
		transfer_state = 563
		transfer_state = 819
		transfer_state = 817


		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_integrated_puppet }
		}
		set_cosmetic_tag = GER_puppet
	}

	GP4 = {
		transfer_state = 637
		transfer_state = 822
		transfer_state = 875
		transfer_state = 874
		transfer_state = 562
		transfer_state = 877
		transfer_state = 876
		transfer_state = 876
		transfer_state = 561
		transfer_state = 560
		transfer_state = 657
		transfer_state = 409
		transfer_state = 408
		transfer_state = 574
		transfer_state = 644

		GER = {
			set_autonomy = { target = PREV autonomy_state = autonomy_integrated_puppet }
		}
		set_cosmetic_tag = GER_puppet
	}
}

jap_capitulation_peace_deal = {
	set_global_flag = JAP_capitulated
	
	#transfer navy first
	JAP = {
		set_cosmetic_tag = USA_puppet

		transfer_navy = {
			target = USA
		}
	}

	#stop the war
	NEU = {
		annex_country = { target = JAP transfer_troops = no } 
		annex_country = { target = CHI transfer_troops = no } 
		annex_country = { target = SIA transfer_troops = no } 
		annex_country = { target = MAN transfer_troops = no } 
		
		release = SIA
		release = CHI
		release = JAP
	}

	USA = {
		puppet = JAP
		transfer_state = 646
		transfer_state = 633
		transfer_state = 684
		transfer_state = 647
		transfer_state = 646
		transfer_state = 648
	}

 	FRA = {
		puppet = SIA

		transfer_state = 648
		transfer_state = 671
		transfer_state = 670
		transfer_state = 286
	}
	CHI = {
		set_cosmetic_tag = CHI

		transfer_state = 524
		transfer_state = 615
		transfer_state = 621
		transfer_state = 616
		transfer_state = 604
		transfer_state = 754
		transfer_state = 755
		transfer_state = 756
		transfer_state = 283
		transfer_state = 746
		transfer_state = 753
		transfer_state = 325
		
		#man
		transfer_state = 328
		transfer_state = 610
		transfer_state = 714
		transfer_state = 715
		transfer_state = 716
		transfer_state = 717
		transfer_state = 761

		#men
		transfer_state = 611
		transfer_state = 612
	}
	KOR = {		
		527 = {
			add_core_of = KOR
			remove_core_of = JAP
		}
		525 = {
			add_core_of = KOR
			remove_core_of = JAP
		}
		transfer_state = 527
		transfer_state = 525
	}
	RAJ = {
		if = {
			limit = {
				exists = yes
			}
			transfer_state = 747
		}
	}
	NZL = {
		if = {
			limit = {
				exists = yes
			}
			transfer_state = 646
			transfer_state = 684
			transfer_state = 641	
		}
	}
	SOV = {
		if = {
			limit = {
				exists = yes
			}
			transfer_state = 537	
		}
	}

	ENG = {
		add_to_faction = JAP
		add_to_faction = CHI
		add_to_faction = KOR
		add_to_faction = SIA
	}
}

chi_capitulation_peace_deal = {
	set_global_flag = CHI_capitulated
	CHI = {
		transfer_navy = {
			target = JAP
		}
	}
	JAP = {
		annex_country = { target = CHI transfer_troops = no }
	}
}

eth_capitulation_peace_deal = {
	set_global_flag = ETH_capitulated

	ITA = {
		transfer_state = 835
		transfer_state = 836
		transfer_state = 837
		transfer_state = 838
		transfer_state = 839
		transfer_state = 840
		transfer_state = 841
		transfer_state = 842
		transfer_state = 843
		transfer_state = 271
		transfer_state = 908
	}			
}

yug_capitulation_peace_deal = {
	set_global_flag = YUG_capitulated

	YUG = {
		transfer_navy = {
			target = ITA
		}
	}	
	ITA = {
		transfer_state = 853
		transfer_state = 102
		transfer_state = 104
		transfer_state = 802
		transfer_state = 804
		transfer_state = 107
		transfer_state = 108
		transfer_state = 45
		transfer_state = 764
		transfer_state = 106
		transfer_state = 803
		transfer_state = 103
		transfer_state = 109
		transfer_state = 105
	}
}

gre_capitulation_peace_deal = {
	set_global_flag = GRE_capitulated

	GRE = {
		transfer_navy = {
			target = ITA
		}
	}
	ITA = {
		transfer_state = 185
		transfer_state = 186
		transfer_state = 182
		transfer_state = 47
		transfer_state = 187
		transfer_state = 184
		transfer_state = 731
	}
}